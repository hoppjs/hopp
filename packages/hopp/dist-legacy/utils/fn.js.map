{"version":3,"sources":["../../src/utils/fn.js"],"names":["cache","Object","create","process","env","RECACHE","fn","last","length","val","i","a","apply"],"mappings":";;;;;;;;AAAA;;;;;;AAMA;;;kBAGe,cAAM;AACnB,MAAMA,QAAQC,OAAOC,MAAP,CAAc,IAAd,CAAd;;AAEA,SAAOC,QAAQC,GAAR,CAAYC,OAAZ,KAAwB,MAAxB,GAAiCC,EAAjC,oDAAsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACrCC,gBADqC,GAC9B,MAAU,MAAUC,MAAV,GAAmB,CAA7B,CAD8B;AAEvCC,eAFuC,GAEjCT,KAFiC;;;AAI3C,iBAASU,CAAT,GAAa,CAAb,EAAgBC,CAAhB,GAAoB,MAAU,CAAV,CAApB,EAAkCD,IAAI,MAAUF,MAAV,GAAmB,CAAzD,EAA4DE,KAAK,CAAL,EAAQC,IAAI,MAAUD,CAAV,CAAxE,EAAsF;AACpFD,oBAAMA,IAAIE,CAAJ,IAASF,IAAIE,CAAJ,KAAUV,OAAOC,MAAP,CAAc,IAAd,CAAzB;AACD;;AAN0C,0BAQvBO,IAAIF,IAAJ,CARuB;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,0CAQJD,GAAGM,KAAH,CAAS,IAAT,+CARI;;AAAA;AAAA;;AAAA;AAAA,6CAQpCH,IAAIF,IAAJ,CARoC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAtC,EAAP;AAUD,C","file":"../../src/utils/fn.js","sourcesContent":["/**\n * @file src/utils/fn.js\n * @license MIT\n * @copyright 2017 10244872 Canada Inc.\n */\n\n/**\n * Makes async functions deterministic.\n */\nexport default fn => {\n  const cache = Object.create(null)\n\n  return process.env.RECACHE === 'true' ? fn : async function () {\n    const last = arguments[arguments.length - 1]\n    let val = cache\n\n    for (let i = 0, a = arguments[0]; i < arguments.length - 1; i += 1, a = arguments[i]) {\n      val = val[a] = val[a] || Object.create(null)\n    }\n\n    return val[last] = (val[last] || await fn.apply(this, [...arguments]))\n  }\n}\n"]}