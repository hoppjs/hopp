{"version":3,"sources":["../../src/utils/fn.js"],"names":["fn","cache","Object","create","process","env","RECACHE","last","arguments","length","val","i","a","apply"],"mappings":";;;;;;;;AAAA;;;;;;AAMA;;;kBAGeA,MAAM;AACnB,QAAMC,QAAQC,OAAOC,MAAP,CAAc,IAAd,CAAd;;AAEA,SAAOC,QAAQC,GAAR,CAAYC,OAAZ,KAAwB,MAAxB,GAAiCN,EAAjC,4BAAsC,aAAkB;AAC7D,UAAMO,OAAOC,UAAUA,UAAUC,MAAV,GAAmB,CAA7B,CAAb;AACA,QAAIC,MAAMT,KAAV;;AAEA,SAAK,IAAIU,IAAI,CAAR,EAAWC,IAAIJ,UAAU,CAAV,CAApB,EAAkCG,IAAIH,UAAUC,MAAV,GAAmB,CAAzD,EAA4DE,KAAK,CAAL,EAAQC,IAAIJ,UAAUG,CAAV,CAAxE,EAAsF;AACpFD,YAAMA,IAAIE,CAAJ,IAASF,IAAIE,CAAJ,KAAUV,OAAOC,MAAP,CAAc,IAAd,CAAzB;AACD;;AAED,WAAOO,IAAIH,IAAJ,IAAaG,IAAIH,IAAJ,MAAa,6BAAMP,GAAGa,KAAH,CAAS,IAAT,EAAe,CAAC,GAAGL,SAAJ,CAAf,CAAN,CAAb,CAApB;AACD,GATM,CAAP;AAUD,C","file":"../../src/utils/fn.js","sourcesContent":["/**\n * @file src/utils/fn.js\n * @license MIT\n * @copyright 2017 10244872 Canada Inc.\n */\n\n/**\n * Makes async functions deterministic.\n */\nexport default fn => {\n  const cache = Object.create(null)\n\n  return process.env.RECACHE === 'true' ? fn : async function () {\n    const last = arguments[arguments.length - 1]\n    let val = cache\n\n    for (let i = 0, a = arguments[0]; i < arguments.length - 1; i += 1, a = arguments[i]) {\n      val = val[a] = val[a] || Object.create(null)\n    }\n\n    return val[last] = (val[last] || await fn.apply(this, [...arguments]))\n  }\n}\n"]}